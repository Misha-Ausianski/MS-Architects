import{b as N,j as a,r as d,c as w}from"./index-BYViq9V_.js";import{B as P}from"./Breadcrumbs-BM9sIGdC.js";import{a as S}from"./queries-DaCwzMhL.js";import{S as R,A as C,P as E,a as k,N as $,b as A}from"./navigation-oGD1PjWT.js";import{R as M}from"./RelatedProjects-BEmPGDtN.js";import"./client-_uLjnSk7.js";import"./ProjectCard-_7pje0Re.js";const T="_gallery_985in_22",B="_slide_985in_31",L="_img_985in_41",O="_pagination_985in_50",I="_bullet_985in_63",z="_progress_985in_80",o={gallery:T,slide:B,img:L,pagination:O,bullet:I,progress:z};function q({children:s}){return typeof document>"u"?null:N.createPortal(s,document.body)}const D="_overlay_1swdc_1",F="_img_1swdc_12",G="_close_1swdc_23",g={overlay:D,img:F,close:G};function H({src:s,onClose:n}){return s?a.jsx(q,{children:a.jsxs("div",{className:g.overlay,onClick:n,children:[a.jsx("img",{className:g.img,src:s,alt:"",onClick:r=>r.stopPropagation()}),a.jsx("button",{className:g.close,onClick:n,"aria-label":"Close",children:"×"})]})}):null}function J({images:s}){const n=d.useRef(null),r=d.useRef(null),[m,_]=d.useState(null),y=(e,t)=>`<span class="${t} ${o.bullet}" tabindex="0">
       <i class="${o.progress}" data-progress></i>
     </span>`,x=e=>{var l,i,u,b,f,h,j,v;if(!e||!n.current)return;(!e.params.pagination||typeof e.params.pagination=="boolean")&&(e.params.pagination={enabled:!0});const t=e.params.pagination;t.el=n.current,t.clickable=!0,t.renderBullet=y,e.pagination&&((i=(l=e.pagination).destroy)==null||i.call(l),(b=(u=e.pagination).init)==null||b.call(u),(h=(f=e.pagination).render)==null||h.call(f),(v=(j=e.pagination).update)==null||v.call(j))};return d.useEffect(()=>{const e=r.current;if(!e)return;x(e);const t=setTimeout(()=>{var l,i;e.update(),(i=(l=e.pagination)==null?void 0:l.update)==null||i.call(l)},0);return()=>clearTimeout(t)},[s.length]),a.jsxs("div",{className:o.gallery,"data-bitrix-block":"PROJECT_GALLERY",children:[a.jsx(R,{modules:[C,E,k,$],onSwiper:e=>{r.current=e},onInit:e=>{x(e)},slidesPerView:"auto",spaceBetween:20,loop:s.length>1,speed:600,watchOverflow:!0,observer:!0,observeParents:!0,observeSlideChildren:!0,updateOnWindowResize:!0,autoHeight:!0,simulateTouch:!0,grabCursor:!0,autoplay:{delay:1e4,disableOnInteraction:!1,pauseOnMouseEnter:!0},pagination:{enabled:!0,clickable:!0,renderBullet:y},onAfterInit:e=>{var t,l;e.update(),(l=(t=e.pagination)==null?void 0:t.update)==null||l.call(t)},onResize:e=>{var t,l;e.update(),(l=(t=e.pagination)==null?void 0:t.update)==null||l.call(t)},onImagesReady:e=>{var t,l;e.update(),(l=(t=e.pagination)==null?void 0:t.update)==null||l.call(t)},onAutoplayTimeLeft:(e,t,l)=>{var u;const i=(u=n.current)==null?void 0:u.querySelector(".swiper-pagination-bullet-active [data-progress]");i&&i.style.setProperty("--p",`${((1-l)*100).toFixed(0)}%`)},onSlideChange:()=>{var e;(e=n.current)==null||e.querySelectorAll("[data-progress]").forEach(t=>t.style.setProperty("--p","0%"))},children:s.map((e,t)=>a.jsx(A,{style:{width:"auto"},children:a.jsx("button",{className:o.slide,onClick:()=>_(e),"aria-label":"Открыть изображение",children:a.jsx("img",{className:o.img,src:e,alt:"",loading:"lazy"})})},t))}),a.jsx("div",{className:`${o.pagination} swiper-pagination`,ref:n}),a.jsx(H,{src:m,onClose:()=>_(null)})]})}const V="_meta_apfoo_1",W="_item_apfoo_7",Y="_label_apfoo_13",K="_value_apfoo_20",p={meta:V,item:W,label:Y,value:K};function Q({project:s}){const n=[s.customer&&{label:"Заказчик",value:s.customer},s.category&&{label:"Наименование проекта",value:s.category},s.area_m2&&{label:"Площадь",value:`${s.area_m2} м²`},s.city&&{label:"Локация",value:s.city},s.year&&{label:"Год создания",value:s.year}].filter(Boolean);return a.jsx("dl",{className:p.meta,"data-bitrix-block":"PROJECT_META",children:n.map((r,m)=>a.jsxs("div",{className:p.item,children:[a.jsx("dt",{className:p.label,children:r.label}),a.jsx("dd",{className:p.value,children:r.value})]},m))})}const U="_head_1l42r_1",X="_title_1l42r_8",Z="_category_1l42r_14",ee="_row_1l42r_25",ae="_projectMeta_1l42r_34",te="_content_1l42r_43",c={head:U,title:X,category:Z,row:ee,projectMeta:ae,content:te};function ue(){const{slug:s=""}=w(),{data:n,isLoading:r}=S(s);return r||!n?a.jsx("div",{className:"skeleton-page"}):a.jsxs(a.Fragment,{children:[a.jsx(P,{}),a.jsx(J,{images:n.gallery}),a.jsx("div",{className:"section",children:a.jsxs("div",{className:"container",children:[a.jsxs("div",{className:c.head,children:[a.jsx("h1",{className:c.title,children:n.title}),a.jsx("div",{className:c.category,children:n.category})]}),a.jsxs("div",{className:c.row,children:[a.jsx("aside",{className:c.projectMeta,children:a.jsx(Q,{project:n})}),a.jsx("article",{className:c.content,children:n.content?a.jsx("div",{dangerouslySetInnerHTML:{__html:n.content}}):a.jsx("p",{children:n.excerpt})})]})]})}),a.jsx(M,{serviceSlug:n.serviceSlug,currentSlug:n.slug,limit:3})]})}export{ue as default};
